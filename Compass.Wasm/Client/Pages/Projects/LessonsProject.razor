@page "/lessons/project/{ProjectId}"

@inject IProjectService ProjectService
<PageTitle>项目经验教训</PageTitle>
<div class="row position-relative">
    <div class="col">
        <h5>
            <a href="drawings/@_projectDto.Id">@_projectDto.OdpNumber</a>
            <span> @_projectDto.Name</span>
            <a href="lessons">[查看所有]</a>
        </h5>
    </div>
    <CompAddButton Roles="admin,pm,mgr" Url="@($"lesson/add/{ProjectId}")" />
</div>
@if (_projectDto.Id != null)
{
    <LessonRow ProjectDto="_projectDto"></LessonRow>
}

@code {
    [Parameter]
    public string ProjectId { get; set; }
    private ProjectDto _projectDto = new();

    protected override async Task OnInitializedAsync()
    {
        var pResult = await ProjectService.GetFirstOrDefault(Guid.Parse(ProjectId));
        if (pResult.Status) _projectDto = pResult.Result;
    }
}
